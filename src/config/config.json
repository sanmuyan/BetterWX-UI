{
    "version": "0.0.34",
    "rules": [
        {
            "code": "wechat",
            "version": "3.9.12.51.105",
            "name": "微信3.9",
            "index": 0,
            "paths": [
                {
                    "code": "install_location",
                    "index": 0,
                    "methods": [
                        {
                            "method": "runtime",
                            "index": 0
                        },
                        {
                            "method": "regedit",
                            "index": 1,
                            "args": {
                                "path": "HKEY_CURRENT_USER\\Software\\Tencent\\WeChat",
                                "field": "InstallPath"
                            }
                        },
                        {
                            "method": "regedit",
                            "index": 2,
                            "args": {
                                "path": "HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\WeChat",
                                "field": "InstallLocation"
                            }
                        }
                    ],
                    "path": "${value}",
                    "file": "${path}\\WeChat.exe"
                },
                {
                    "code": "install_version",
                    "index": 1,
                    "methods": [
                        {
                            "method": "fileinfo",
                            "index": 0,
                            "retry": 3,
                            "args": {
                                "path": "${install_location.file}"
                            }
                        },
                        {
                            "method": "regedit",
                            "index": 1,
                            "args": {
                                "path": "HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\WeChat",
                                "field": "DisplayVersion"
                            }
                        }
                    ],
                    "path": "${install_location.path}\\[${value}]",
                    "file": "${path}\\WeChatWin.dll"
                }
            ],
            "variables": [
                {
                    "code": "bak_path_dll",
                    "value": "${install_location}\\[${install_version}]\\WeChatWin.dll.bak"
                },
                {
                    "code": "bak_path_exe",
                    "value": "${install_location}\\WeChat.exe.bak"
                },
                {
                    "code": "path_dll",
                    "value": "${install_location}\\[${install_version}]\\WeChatWin.dll"
                },
                {
                    "code": "path_exe",
                    "value": "${install_location}\\WeChat.exe"
                },
                {
                    "code": "new_path_dll",
                    "value": "${install_location}\\[${install_version}]\\WeChatWin.dl${num}"
                },
                {
                    "code": "new_path_exe",
                    "value": "${install_location}\\WeChat${num}.exe"
                }
            ],
            "patches": [
                {
                    "code": "revoke",
                    "path": "${path_dll}",
                    "patterns": [
                        {
                            "version": "3.9.12.51",
                            "pattern": "EBBF418B00240F3C02",
                            "replace": "9090..."
                        }
                    ]
                },
                {
                    "code": "mutex",
                    "path": "${path_dll}",
                    "patterns": [
                        {
                            "version": "3.9.12.51",
                            "pattern": "FF15????????488BF04532F64C8D25????????4885C00F84",
                            "replace": "...90e9"
                        }
                    ]
                },
                {
                    "code": "exe_dll",
                    "path": "${path_exe}",
                    "multiple": true,
                    "patterns": [
                        {
                            "version": "3.9.12.51",
                            "pattern": "570065004300680061007400570069006E002E0064006C006C",
                            "replace": "...${num_u8}"
                        }
                    ]
                },
                {
                    "code": "dll_dll",
                    "path": "${path_dll}",
                    "multiple": true,
                    "patterns": [
                        {
                            "version": "3.9.12.51",
                            "pattern": "570065004300680061007400570069006E002E0064006C006C",
                            "replace": "...${num_u8}"
                        }
                    ]
                },
                {
                    "code": "dll_dll2",
                    "path": "${path_dll}",
                    "multiple": true,
                    "patterns": [
                        {
                            "version": "3.9.12.51",
                            "pattern": "57654368617457696E2E646C6C",
                            "replace": "...${num_u8}"
                        }
                    ]
                },
                {
                    "code": "dll_dll3",
                    "path": "${path_dll}",
                    "multiple": true,
                    "patterns": [
                        {
                            "version": "3.9.12.51",
                            "pattern": "770065006300680061007400770069006E002E0064006C006C",
                            "replace": "...${num_u8}"
                        }
                    ]
                },
                {
                    "code": "config",
                    "path": "${path_dll}",
                    "multiple": true,
                    "patterns": [
                        {
                            "version": "3.9.12.51",
                            "pattern": "63006F006E006600690067002E0064006100740061",
                            "replace": "63006F006E006600${num_u8}..."
                        }
                    ]
                },
                {
                    "code": "host",
                    "path": "${path_dll}",
                    "patterns": [
                        {
                            "version": "3.9.12.51",
                            "pattern": "686F73742D72656469726563742E786D6C",
                            "replace": "...${num_u8}"
                        }
                    ]
                },
                {
                    "code": "mutex_name",
                    "path": "${path_dll}",
                    "patterns": [
                        {
                            "version": "3.9.12.51",
                            "pattern": "650043006800610074005F004100700070005F0049006E007300740061006E0063",
                            "replace": "${num_u8}..."
                        }
                    ]
                },
                {
                    "code": "window_name",
                    "path": "${path_dll}",
                    "patterns": [
                        {
                            "version": "3.9.12.51",
                            "pattern": "5700650043006800610074004D00610069",
                            "replace": "${num_u8}..."
                        }
                    ]
                },
                {
                    "code": "window_login_name",
                    "path": "${path_dll}",
                    "patterns": [
                        {
                            "version": "3.9.12.51",
                            "pattern": "5700650043006800610074004C006F00670069006E0057006E00640046006F00720050004300",
                            "replace": "${num_u8}..."
                        }
                    ]
                }
            ],
            "features": [
                "select",
                "select_all",
                "open_all",
                "close_all",
                "refresh",
                "clear",
                "open",
                "close",
                "floder",
                "revoke",
                "note",
                "lnk",
                "del",
                {
                    "code": "mutex",
                    "name": "多开",
                    "method": "patch",
                    "description": "建议使用共存方案或单独多开工具",
                    "inmain": true,
                    "index": 50,
                    "tdelay": 100,
                    "style": "switch",
                    "supported": true,
                    "dependencies": [
                        "mutex"
                    ]
                },
                {
                    "code": "coexist",
                    "name": "共存",
                    "method": "",
                    "description": "制作共存文件",
                    "inmain": true,
                    "incoexist": false,
                    "index": 150,
                    "style": "button",
                    "supported": true,
                    "target": "",
                    "dependencies": [
                        "mutex_name",
                        "config",
                        "exe_dll",
                        "dll_dll",
                        "dll_dll2",
                        "dll_dll3",
                        "host",
                        "window_name",
                        "window_login_name",
                        "-mutex"
                    ]
                }
            ]
        },
        {
            "code": "weixin",
            "version": "4.0.6.12.100",
            "name": "微信4.0",
            "index": 1,
            "paths": [
                {
                    "code": "install_location",
                    "index": 0,
                    "methods": [
                        {
                            "method": "runtime",
                            "index": 0
                        },
                        {
                            "method": "regedit",
                            "index": 1,
                            "args": {
                                "path": "HKEY_CURRENT_USER\\Software\\Tencent\\Weixin",
                                "field": "InstallPath"
                            }
                        },
                        {
                            "method": "regedit",
                            "index": 2,
                            "args": {
                                "path": "HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\Weixin",
                                "field": "InstallLocation"
                            }
                        }
                    ],
                    "path": "${value}",
                    "file": "${path}\\Weixin.exe"
                },
                {
                    "code": "install_version",
                    "index": 1,
                    "methods": [
                        {
                            "method": "fileinfo",
                            "index": 0,
                            "retry": 3,
                            "args": {
                                "path": "${install_location.file}"
                            }
                        },
                        {
                            "method": "regedit",
                            "index": 1,
                            "args": {
                                "path": "HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\Weixin",
                                "field": "DisplayVersion"
                            }
                        }
                    ],
                    "path": "${install_location.path}\\${value}",
                    "file": "${path}\\Weixin.dll"
                }
            ],
            "variables": [
                {
                    "code": "bak_path_dll",
                    "value": "${install_location}\\${install_version}\\Weixin.dll.bak"
                },
                {
                    "code": "bak_path_exe",
                    "value": "${install_location}\\Weixin.exe.bak"
                },
                {
                    "code": "path_dll",
                    "value": "${install_location}\\${install_version}\\Weixin.dll"
                },
                {
                    "code": "new_path_dll",
                    "value": "${install_location}\\${install_version}\\Weixin.dl${num}"
                },
                {
                    "code": "path_exe",
                    "value": "${install_location}\\Weixin.exe"
                },
                {
                    "code": "new_path_exe",
                    "value": "${install_location}\\Weixin${num}.exe"
                }
            ],
            "patches": [
                {
                    "code": "revoke",
                    "path": "${path_dll}",
                    "patterns": [
                        {
                            "version": "4.0.6",
                            "pattern": "31F6E9????0000488D8D00040000E8????????84C00F84",
                            "replace": "...90E9"
                        },
                        {
                            "version": "4.0.3",
                            "pattern": "EB??488D8D00??0000E8????????84C0746E",
                            "replace": "...EB6E"
                        }
                    ]
                },
                {
                    "code": "dllname",
                    "path": "${path_exe}",
                    "patterns": [
                        {
                            "version": "4.0.3",
                            "pattern": "570065006900780069006E002E0064006C006C",
                            "replace": "...${num_u8}"
                        }
                    ]
                },
                {
                    "code": "host",
                    "path": "${path_dll}",
                    "patterns": [
                        {
                            "version": "4.0.3",
                            "pattern": "686F73742D72656469726563742E786D6C",
                            "replace": "...${num_u8}"
                        }
                    ]
                },
                {
                    "code": "config",
                    "path": "${path_dll}",
                    "patterns": [
                        {
                            "version": "4.0.3",
                            "pattern": "48B8676C6F62616C5F63488905????????C705????????6F6E666966C705????????67",
                            "replace": "...c705????????6f6e66${num_u8}66c705????????67"
                        }
                    ]
                },
                {
                    "code": "mutex",
                    "path": "${path_dll}",
                    "patterns": [
                        {
                            "version": "4.0.3",
                            "pattern": "555657534881ECC8010000488DAC248000000048C78540010000FEFFFFFF48C785A800000000000000B960000000",
                            "replace": "c3..."
                        }
                    ]
                },
                {
                    "code": "mutex_name",
                    "path": "${path_dll}",
                    "patterns": [
                        {
                            "version": "4.0.3",
                            "pattern": "580057006500430068006100",
                            "replace": "${num_u8}..."
                        }
                    ]
                },
                {
                    "code": "window_name",
                    "path": "${path_dll}",
                    "patterns": [
                        {
                            "version": "4.0.3",
                            "pattern": "7800570065006300680061007400570069006E0064006F0077",
                            "replace": "...${num_u8}"
                        }
                    ]
                },
                {
                    "code": "revoke2",
                    "path": "${path_dll}",
                    "patterns": [
                        {
                            "version": "4.0.6",
                            "pattern": "4889F2E8????????89C6488BBDB80000004885FF",
                            "replace": "4889F2BE122700009090..."
                        },
                        {
                            "version": "4.0.3",
                            "pattern": "488B0848898D200300004889BD280300004889F2E8????????89C64885FF741D",
                            "replace": "...8BB52004000081C612270000"
                        }
                    ]
                },
                {
                    "code": "revoke2_cmp",
                    "path": "${path_dll}",
                    "patterns": [
                        {
                            "version": "4.0.3",
                            "pattern": "4889F2E8??????????????00000F1F8400000000004889D94889F2",
                            "replace": "...3D122700000F856202000090904889D94889F2"
                        }
                    ]
                },
                {
                    "code": "revoke2_text1",
                    "description": "窗口撤回提示消息",
                    "path": "${path_dll}",
                    "patterns": [
                        {
                            "version": "4.0.3",
                            "pattern": "E69A82E4B88DE694AFE68C81E8AFA5E58685E5AEB9EFBC8CE8AFB7E59CA8E6898BE69CBAE4B88AE69FA5E79C8B00",
                            "replace": "E692A4E59B9EE4BA86E4B880E69DA1E6B688E681AF00..."
                        }
                    ]
                },
                {
                    "code": "revoke2_text2",
                    "description": "列表撤回提示消息",
                    "path": "${path_dll}",
                    "patterns": [
                        {
                            "version": "4.0.3",
                            "pattern": "5BE4B88DE694AFE68C81E7B1BBE59E8BE6B688E681AF5D00",
                            "replace": "5BE692A4E59B9EE4BA86E4B880E69DA1E6B688E681AF5D00"
                        }
                    ]
                },
                {
                    "code": "revoke3",
                    "description": "屏蔽撤回提示消息",
                    "path": "${path_dll}",
                    "multiple": true,
                    "patterns": [
                        {
                            "version": "4.0.6",
                            "pattern": "488D55C04531C0E8????????488BBD480400004885FF",
                            "replace": "488D55C0488385C002000001..."
                        },
                        {
                            "version": "4.0.3",
                            "pattern": "488D55C04531C0E8????????4885FF",
                            "replace": "488D55C0488385C0020000014885FF"
                        }
                    ]
                },
                {
                    "code": "revoke3_id",
                    "description": "撤回提示id",
                    "path": "${path_dll}",
                    "patterns": [
                        {
                            "version": "4.0.3",
                            "pattern": "564883EC304889D6C644242000E8????????4889F04883C4305EC3",
                            "replace": "564883EC304889D6C644242001..."
                        }
                    ]
                }
            ],
            "features": [
                "select",
                "select_all",
                "open_all",
                "close_all",
                "refresh",
                "clear",
                "open",
                "close",
                "floder",
                "del",
                "coexist",
                "note",
                "lnk",
                {
                    "code": "mutex",
                    "name": "多开",
                    "method": "patch",
                    "description": "建议使用共存方案或单独多开工具",
                    "inmain": true,
                    "index": 50,
                    "tdelay": 100,
                    "style": "switch",
                    "supported": true,
                    "dependencies": [
                        "mutex"
                    ]
                },
                {
                    "code": "revoke",
                    "name": "防撤",
                    "method": "patch",
                    "description": "防撤无提示",
                    "inmain": true,
                    "incoexist": true,
                    "tdelay": 100,
                    "index": 40,
                    "style": "switch",
                    "supported": true,
                    "target": "",
                    "dependencies": [
                        "revoke",
                        "-revoke2",
                        "-revoke2_cmp",
                        "-revoke2_text1",
                        "-revoke2_text2",
                        "-revoke3",
                        "-revoke3_id"
                    ]
                },
                {
                    "code": "revoke2",
                    "name": "防撤2",
                    "method": "patch",
                    "description": "防撤+提示",
                    "inmain": true,
                    "incoexist": true,
                    "tdelay": 100,
                    "index": 41,
                    "style": "switch",
                    "supported": true,
                    "dependencies": [
                        "revoke2",
                        "revoke2_cmp",
                        "revoke2_text1",
                        "revoke2_text2",
                        "-revoke",
                        "-revoke3",
                        "-revoke3_id"
                    ]
                },
                {
                    "code": "revoke3",
                    "name": "防撤3",
                    "method": "patch",
                    "description": "防撤+提示，需要手动切换窗口(方案来自EEEEhex、zetaloop)",
                    "tdelay": 100,
                    "inmain": true,
                    "incoexist": true,
                    "index": 42,
                    "style": "switch",
                    "supported": true,
                    "dependencies": [
                        "revoke3",
                        "revoke3_id",
                        "-revoke2",
                        "-revoke2_cmp",
                        "-revoke2_text1",
                        "-revoke2_text2",
                        "-revoke"
                    ]
                },
                {
                    "code": "revoke2_text",
                    "name": "撤回文字",
                    "method": "patch_input",
                    "description": "修改撤回提示消息",
                    "inmain": true,
                    "incoexist": true,
                    "index": 121,
                    "tdelay": 300,
                    "style": "button",
                    "supported": true,
                    "dependfeature": [
                        "revoke2"
                    ],
                    "dependencies": [
                        "revoke2_text1",
                        "revoke2_text2"
                    ]
                }
            ]
        },
        {
            "code": "wxwork",
            "version": "4.1.36.8007.100",
            "name": "企业微信",
            "index": 2,
            "paths": [
                {
                    "code": "install_location",
                    "index": 0,
                    "methods": [
                        {
                            "method": "runtime",
                            "index": 0
                        },
                        {
                            "method": "regedit",
                            "index": 1,
                            "args": {
                                "path": "HKEY_CURRENT_USER\\Software\\Tencent\\WXWork",
                                "field": "Executable"
                            },
                            "unsuffix": "\\WXWork.exe"
                        },
                        {
                            "method": "regedit",
                            "index": 2,
                            "args": {
                                "path": "HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\企业微信",
                                "field": "DisplayIcon"
                            },
                            "unsuffix": "\\WXWork.exe"
                        }
                    ],
                    "path": "${value}",
                    "file": "${path}\\WXWork.exe"
                },
                {
                    "code": "install_version",
                    "index": 1,
                    "methods": [
                        {
                            "method": "fileinfo",
                            "index": 0,
                            "retry": 3,
                            "args": {
                                "path": "${install_location.file}"
                            }
                        },
                        {
                            "method": "regedit",
                            "index": 1,
                            "args": {
                                "path": "HKEY_CURRENT_USER\\Software\\Tencent\\WXWork",
                                "field": "4.1.38.6011"
                            }
                        },
                        {
                            "method": "regedit",
                            "index": 2,
                            "args": {
                                "path": "HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\企业微信",
                                "field": "DisplayVersion"
                            }
                        }
                    ],
                    "path": "${install_location.path}\\${value}",
                    "file": "${path}\\WXWorkResources.dll"
                }
            ],
            "variables": [
                {
                    "code": "bak_path_exe",
                    "value": "${install_location}\\WXWork.exe.bak"
                },
                {
                    "code": "path_exe",
                    "value": "${install_location}\\WXWork.exe"
                },
                {
                    "code": "new_path_exe",
                    "value": "${install_location}\\WXWork${num}.exe"
                }
            ],
            "patches": [
                {
                    "code": "host",
                    "path": "${path_exe}",
                    "patterns": [
                        {
                            "version": "4.1.36.8007",
                            "pattern": "68747470646E732E63666700",
                            "replace": "...${num_u8}2E63666700"
                        }
                    ]
                },
                {
                    "code": "config_cfg1",
                    "path": "${path_exe}",
                    "multiple": true,
                    "patterns": [
                        {
                            "version": "4.1.36.8007",
                            "pattern": "436F6E6669672E636667",
                            "replace": "...${num_u8}2E636667"
                        }
                    ]
                },
                {
                    "code": "config_cfg2",
                    "path": "${path_exe}",
                    "multiple": true,
                    "patterns": [
                        {
                            "version": "4.1.36.8007",
                            "pattern": "43006F006E006600690067002E006300660067",
                            "replace": "...${num_u8}002E006300660067"
                        }
                    ]
                },
                {
                    "code": "config_db",
                    "path": "${path_exe}",
                    "patterns": [
                        {
                            "version": "4.1.36.8007",
                            "pattern": "636F6E6669672E6462",
                            "replace": "...${num_u8}2E6462"
                        }
                    ]
                },
                {
                    "code": "corp_logo1",
                    "path": "${path_exe}",
                    "multiple": true,
                    "patterns": [
                        {
                            "version": "4.1.36.8007",
                            "pattern": "63006F00720070005F006C006F0067006F",
                            "replace": "...${num_u8}"
                        }
                    ]
                },
                {
                    "code": "corp_logo2",
                    "path": "${path_exe}",
                    "multiple": true,
                    "patterns": [
                        {
                            "version": "4.1.36.8007",
                            "pattern": "636F72705F6C6F676F",
                            "replace": "...${num_u8}"
                        }
                    ]
                },
                {
                    "code": "avator",
                    "path": "${path_exe}",
                    "patterns": [
                        {
                            "version": "4.1.36.8007",
                            "pattern": "7172636F64655F6C6F67696E5F757365725F617661746F72",
                            "replace": "...${num_u8}"
                        }
                    ]
                },
                {
                    "code": "mutex_name",
                    "path": "${path_exe}",
                    "multiple": true,
                    "patterns": [
                        {
                            "version": "4.1.36.8007",
                            "pattern": "540065006E00630065006E0074002E005700650057006F0072006B002E004500780063006C0075",
                            "replace": "...${num_u8}"
                        }
                    ]
                },
                {
                    "code": "window_name",
                    "path": "${path_exe}",
                    "multiple": true,
                    "patterns": [
                        {
                            "version": "4.1.36.8007",
                            "pattern": "540065006E00630065006E0074002E005700650057006F0072006B002E00410063007400690076006100740065004100700070006C00690063006100740069006F006E",
                            "replace": "...${num_u8}"
                        }
                    ]
                },
                {
                    "code": "disable_del_add_tray",
                    "path": "${path_exe}",
                    "patterns": [
                        {
                            "version": "4.1.36.8007",
                            "pattern": "3973??745D39B3????????",
                            "replace": "3973??EB..."
                        }
                    ]
                },
                {
                    "code": "fix_update_tray",
                    "path": "${path_exe}",
                    "patterns": [
                        {
                            "version": "4.1.36.8007",
                            "pattern": "80790800741683C10C837914077602",
                            "replace": "834208${num_u8}83420810836A0C2090EB0D"
                        }
                    ]
                }
            ],
            "features": [
                "select",
                "select_all",
                "open_all",
                "close_all",
                "refresh",
                "clear",
                "open",
                "close",
                "floder",
                "del",
                "note",
                "lnk",
                {
                    "code": "coexist",
                    "name": "共存",
                    "method": "",
                    "description": "制作共存文件",
                    "inmain": true,
                    "incoexist": false,
                    "index": 150,
                    "style": "button",
                    "supported": true,
                    "target": "",
                    "dependencies": [
                        "host",
                        "config_cfg1",
                        "config_cfg2",
                        "config_db",
                        "corp_logo1",
                        "corp_logo2",
                        "avator",
                        "mutex_name",
                        "window_name",
                        "disable_del_add_tray",
                        "fix_update_tray"
                    ]
                }
            ]
        }
    ]
}