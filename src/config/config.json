{
    "version": "0.0.21",
    "rules": [
        {
            "code": "wechat",
            "version": "3.9.12.51.100",
            "name": "微信3.9",
            "index": 0,
            "regedit": {
                "path": "SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\WeChat",
                "fields": [
                    {
                        "code": "install_location",
                        "value": "InstallLocation"
                    }
                ]
            },
            "variables": [
                {
                    "code": "bak_path_dll",
                    "value": "${install_location}\\[${install_version}]\\WeChatWin.dll.bak"
                },
                {
                    "code": "bak_path_exe",
                    "value": "${install_location}\\WeChat.exe.bak"
                },
                {
                    "code": "path_dll",
                    "value": "${install_location}\\[${install_version}]\\WeChatWin.dll"
                },
                {
                    "code": "path_exe",
                    "value": "${install_location}\\WeChat.exe"
                },
                {
                    "code": "new_path_dll",
                    "value": "${install_location}\\[${install_version}]\\WeChatWin.dl${num}"
                },
                {
                    "code": "new_path_exe",
                    "value": "${install_location}\\WeChat${num}.exe"
                }
            ],
            "patches": [
                {
                    "code": "install_version",
                    "path": "${path_exe}",
                    "saveas": "${path_exe}",
                    "target": "${path_exe}",
                    "asvariables": true,
                    "multiple": true,
                    "supported": true,
                    "pattern": "(33002E00\\d{4,8}2E00\\d{4,8}2E00\\d{4,8})0000",
                    "patterns": []
                },
                {
                    "code": "revoke",
                    "path":"${path_dll}",
                    "patterns": [
                        {
                            "version": "3.9.12.51",
                            "pattern": "EBBF418B00240F3C02",
                            "replace": "9090..."
                        }
                    ]
                },
                {
                    "code": "mutex",
                    "path": "${path_dll}",
                    "patterns": [
                        {
                            "version": "3.9.12.51",
                            "pattern": "FF15????????488BF04532F64C8D25????????4885C00F84",
                            "replace": "...90e9"
                        }
                    ]
                },
                {
                    "code": "exe_dll",
                    "path": "${path_exe}",
                    "multiple": true,
                    "patterns": [
                        {
                            "version": "3.9.12.51",
                            "pattern": "570065004300680061007400570069006E002E0064006C006C",
                            "replace": "...${num_u8}"
                        }
                    ]
                },
                {
                    "code": "dll_dll",
                    "path": "${path_dll}",
                    "multiple": true,
                    "patterns": [
                        {
                            "version": "3.9.12.51",
                            "pattern": "570065004300680061007400570069006E002E0064006C006C",
                            "replace": "...${num_u8}"
                        }
                    ]
                },
                {
                    "code": "dll_dll2",
                    "path": "${path_dll}",
                    "multiple": true,
                    "patterns": [
                        {
                            "version": "3.9.12.51",
                            "pattern": "57654368617457696E2E646C6C",
                            "replace": "...${num_u8}"
                        }
                    ]
                },
                {
                    "code": "dll_dll3",
                    "path": "${path_dll}",
                    "multiple": true,
                    "patterns": [
                        {
                            "version": "3.9.12.51",
                            "pattern": "770065006300680061007400770069006E002E0064006C006C",
                            "replace": "...${num_u8}"
                        }
                    ]
                },
                {
                    "code": "config",
                    "path": "${path_dll}",
                    "multiple": true,
                    "patterns": [
                        {
                            "version": "3.9.12.51",
                            "pattern": "63006F006E006600690067002E0064006100740061",
                            "replace": "63006F006E006600${num_u8}..."
                        }
                    ]
                },
                {
                    "code": "host",
                    "path": "${path_dll}",
                    "patterns": [
                        {
                            "version": "3.9.12.51",
                            "pattern": "686F73742D72656469726563742E786D6C",
                            "replace": "...${num_u8}"
                        }
                    ]
                },
                {
                    "code": "mutex_name",
                    "path": "${path_dll}",
                    "patterns": [
                        {
                            "version": "3.9.12.51",
                            "pattern": "650043006800610074005F004100700070005F0049006E007300740061006E0063",
                            "replace": "${num_u8}..."
                        }
                    ]
                },
                {
                    "code": "window_name",
                    "path": "${path_dll}",
                    "patterns": [
                        {
                            "version": "3.9.12.51",
                            "pattern": "5700650043006800610074004D00610069",
                            "replace": "${num_u8}..."
                        }
                    ]
                },
                {
                    "code": "window_login_name",
                    "path": "${path_dll}",
                    "patterns": [
                        {
                            "version": "3.9.12.51",
                            "pattern": "5700650043006800610074004D00610069",
                            "replace": "${num_u8}..."
                        }
                    ]
                }
            ],
            "features": [
                "select",
                "select_all",
                "open_all",
                "close_all",
                "refresh",
                "clear",
                "open",
                "floder",
                "revoke",
                "note",
                "del",
                {
                    "code": "mutex",
                    "name": "多开",
                    "method": "patch",
                    "description": "建议使用共存方案",
                    "inmain": true,
                    "index": 50,
                    "tdelay": 100,
                    "style": "switch",
                    "supported": true,
                    "dependencies": [
                        "mutex"
                    ]
                },
                {
                    "code": "coexist",
                    "name": "共存",
                    "method": "",
                    "description": "制作共存文件",
                    "inmain": true,
                    "incoexist": false,
                    "index": 150,
                    "style": "button",
                    "supported": true,
                    "target": "",
                    "dependencies": [
                        "mutex_name",
                        "config",
                        "exe_dll",
                        "dll_dll",
                        "dll_dll2",
                        "dll_dll3",
                        "config",
                        "host",
                        "window_name",
                        "window_login_name",
                        "-mutex"
                    ]
                }
            ]
        },
        {
            "code": "weixin",
            "version": "4.0.5.7",
            "name": "微信4",
            "index": 0,
            "regedit": {
                "path": "SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\Weixin",
                "fields": [
                    {
                        "code": "install_location",
                        "value": "InstallLocation"
                    }
                ]
            },
            "variables": [
                 {
                    "code": "bak_path_dll",
                    "value": "${install_location}\\${install_version}\\Weixin.dll.bak"
                },
                {
                    "code": "bak_path_exe",
                    "value": "${install_location}\\Weixin.exe.bak"
                },
                {
                    "code": "path_dll",
                    "value": "${install_location}\\${install_version}\\Weixin.dll"
                },
                {
                    "code": "new_path_dll",
                    "value": "${install_location}\\${install_version}\\Weixin.dl${num}"
                },
                {
                    "code": "path_exe",
                    "value": "${install_location}\\Weixin.exe"
                },
                {
                    "code": "new_path_exe",
                    "value": "${install_location}\\Weixin${num}.exe"
                }
            ],
            "patches": [
                {
                    "code": "install_version",
                    "path": "${path_exe}",
                    "target": "${path_exe}",
                    "saveas": "${path_exe}",
                    "asvariables": true,
                    "multiple": true,
                    "supported": true,
                    "pattern": "(342E\\d{2,4}2E\\d{2,4}2E\\d{2,4})4889",
                    "patterns": []
                },
                {
                    "code": "revoke",
                    "path": "${path_dll}",
                    "patterns": [
                        {
                            "version": "4.0.3",
                            "pattern": "EB??488D8D00??0000E8????????84C0746E",
                            "replace": "...EB6E"
                        }
                    ]
                },
                {
                    "code": "dllname",
                    "path": "${path_exe}",
                    "patterns": [
                        {
                            "version": "4.0.3",
                            "pattern": "570065006900780069006E002E0064006C006C",
                            "replace": "...${num_u8}"
                        }
                    ]
                },
                {
                    "code": "host",
                    "path": "${path_dll}",
                    "patterns": [
                        {
                            "version": "4.0.3",
                            "pattern": "686F73742D72656469726563742E786D6C",
                            "replace": "...${num_u8}"
                        }
                    ]
                },
                {
                    "code": "config",
                    "path": "${path_dll}",
                    "patterns": [
                        {
                            "version": "4.0.3",
                            "pattern": "48B8676C6F62616C5F63488905????????C705????????6F6E666966C705????????6700",
                            "replace": "...c705????????6f6e66${num_u8}66c705????????6700"
                        }
                    ]
                },
                {
                    "code": "mutex",
                    "path": "${path_dll}",
                    "patterns": [
                        {
                            "version": "4.0.3",
                            "pattern": "555657534881ECC8010000488DAC248000000048C78540010000FEFFFFFF48C785A800000000000000B960000000",
                            "replace": "c3..."
                        }
                    ]
                },
                {
                    "code": "mutex_name",
                    "path": "${path_dll}",
                    "patterns": [
                        {
                            "version": "4.0.3",
                            "pattern": "580057006500430068006100",
                            "replace": "${num_u8}..."
                        }
                    ]
                },
                {
                    "code": "window_name",
                    "path": "${path_dll}",
                    "patterns": [
                        {
                            "version": "4.0.3",
                            "pattern": "7800570065006300680061007400570069006E0064006F0077",
                            "replace": "...${num_u8}"
                        }
                    ]
                },
                {
                    "code": "window_login_name",
                    "path": "${path_dll}",
                    "patterns": [
                        {
                            "version": "4.0.3",
                            "pattern": "5700650043006800610074004D00610069",
                            "replace": "${num_u8}..."
                        }
                    ]
                },
                {
                    "code": "revoke2",
                    "path": "${path_dll}",
                    "patterns": [
                        {
                            "version": "4.0.3",
                            "pattern": "488B0848898D200300004889BD280300004889F2E8????????89C64885FF741D",
                            "replace": "...8BB52004000081C612270000"
                        }
                    ]
                },
                {
                    "code": "revoke2_cmp",
                    "path": "${path_dll}",
                    "patterns": [
                        {
                            "version": "4.0.3",
                            "pattern": "4889F2E8??????????????00000F1F8400000000004889D94889F2",
                            "replace": "...3D122700000F856202000090904889D94889F2"
                        }
                    ]
                },
                {
                    "code": "revoke2_text1",
                    "description": "窗口撤回提示消息",
                    "path": "${path_dll}",
                    "patterns": [
                        {
                            "version": "4.0.3",
                            "pattern": "E69A82E4B88DE694AFE68C81E8AFA5E58685E5AEB9EFBC8CE8AFB7E59CA8E6898BE69CBAE4B88AE69FA5E79C8B00",
                            "replace": "E692A4E59B9EE4BA86E4B880E69DA1E6B688E681AF00..."
                        }
                    ]
                },
                {
                    "code": "revoke2_text2",
                    "description": "列表撤回提示消息",
                    "path": "${path_dll}",
                    "patterns": [
                        {
                            "version": "4.0.3",
                            "pattern": "5BE4B88DE694AFE68C81E7B1BBE59E8BE6B688E681AF5D00",
                            "replace": "5BE692A4E59B9EE4BA86E4B880E69DA1E6B688E681AF5D00"
                        }
                    ]
                },
                {
                    "code": "revoke3",
                    "description": "屏蔽撤回提示消息",
                    "path": "${path_dll}",
                    "multiple":true,
                    "patterns": [
                        {
                            "version": "4.0.3",
                            "pattern": "488D55C04531C0E8????????4885FF",
                            "replace": "488D55C0488385C0020000014885FF"
                        }

                        
                    ]
                },
                {
                    "code": "revoke3_id",
                    "description": "撤回提示id",
                    "path": "${path_dll}",
                    "patterns": [
                        {
                            "version": "4.0.3",
                            "pattern": "564883EC304889D6C644242000E8????????4889F04883C4305EC3",
                            "replace": "564883EC304889D6C644242001..."
                        }
                    ]
                }
            ],
            "features": [
                "select",
                "select_all",
                "open_all",
                "close_all",
                "refresh",
                "clear",
                "open",
                "floder",
                "del",
                "coexist",
                "note",
                {
                    "code": "revoke",
                    "name": "防撤",
                    "method": "patch",
                    "description": "防撤无提示",
                    "inmain": true,
                    "incoexist": true,
                    "tdelay": 100,
                    "index": 40,
                    "style": "switch",
                    "supported": true,
                    "target": "",
                    "dependencies": [
                        "revoke",
                        "-revoke2",
                        "-revoke2_cmp",
                        "-revoke2_text1",
                        "-revoke2_text2",
                        "-revoke3",
                        "-revoke3_id"
                    ]
                },
                {
                    "code": "revoke2",
                    "name": "防撤2",
                    "method": "patch",
                    "description": "防撤+提示",
                    "inmain": true,
                    "incoexist": true,
                    "tdelay": 100,
                    "index": 41,
                    "style": "switch",
                    "supported": true,
                    "dependencies": [
                        "revoke2",
                        "revoke2_cmp",
                        "revoke2_text1",
                        "revoke2_text2",
                        "-revoke",
                        "-revoke3",
                        "-revoke3_id"
                    ]
                },
                {
                    "code": "revoke3",
                    "name": "防撤3",
                    "method": "patch",
                    "description": "防撤+提示，需要手动切换窗口(方案来自EEEEhex、zetaloop)",
                    "tdelay": 100,
                    "inmain": true,
                    "incoexist": true,
                    "index": 42,
                    "style": "switch",
                    "supported": true,
                    "dependencies": [
                        "revoke3",
                        "revoke3_id",
                        "-revoke2",
                        "-revoke2_cmp",
                        "-revoke2_text1",
                        "-revoke2_text2",
                        "-revoke"
                    ]
                },
                {
                    "code": "revoke2_text",
                    "name": "自定义撤回消息",
                    "method": "patch_input",
                    "description": "修改撤回提示消息",
                    "inmain": true,
                    "incoexist": true,
                    "index": 121,
                    "tdelay": 300,
                    "style": "button",
                    "supported": true,
                    "dependfeature": [
                        "revoke2"
                    ],
                    "dependencies": [
                        "revoke2_text1",
                        "revoke2_text2"
                    ]
                }
            ]
        }
    ]
}